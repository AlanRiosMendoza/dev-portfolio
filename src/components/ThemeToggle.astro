<div
  id="theme-switch"
  class="relative inline-flex items-center w-14 h-8 bg-gray-300 rounded-full cursor-pointer dark:bg-gray-700"
>
  <div
    id="switch-knob"
    class="absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-md transition-transform"
  >
    <svg class="w-4 h-4 text-yellow-400 m-auto mt-1 icon-light">
      <use xlink:href="#Sun"></use>
    </svg>

    <span class="sr-only">Toggle theme</span>
    <svg class="w-4 h-4 text-blue-500 m-auto mt-1 icon-dark hidden">
      <use xlink:href="#Moon"></use>
    </svg>
  </div>
</div>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const switchEl = document.getElementById("theme-switch");
    const knob = document.getElementById("switch-knob");
    const iconLight = knob.querySelector(".icon-light");
    const iconDark = knob.querySelector(".icon-dark");

    function setTheme(theme) {
      const isDark = theme === "dark";
      document.documentElement.classList.toggle("dark", isDark);
      localStorage.setItem("theme", theme);

      knob.style.transform = isDark ? "translateX(24px)" : "translateX(0)";
      iconLight.classList.toggle("hidden", isDark);
      iconDark.classList.toggle("hidden", !isDark);
    }

    const storedTheme =
      localStorage.getItem("theme") ||
      (window.matchMedia("(prefers-color-scheme: dark)").matches
        ? "dark"
        : "light");

    setTheme(storedTheme);

    switchEl.addEventListener("click", () => {
      const currentTheme = localStorage.getItem("theme");
      setTheme(currentTheme === "light" ? "dark" : "light");
    });
  });
</script>
